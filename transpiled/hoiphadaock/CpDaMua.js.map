{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "application",
    "Standalone",
    "members",
    "createTable",
    "BACKGROUND_LO",
    "BACKGROUND_LAI",
    "BACKGROUND_TRAN",
    "BACKGROUND_TANG",
    "BACKGROUND_DUNG",
    "BACKGROUND_GIAM",
    "BACKGROUND_SAN",
    "BACKGROUND_NONE",
    "tableModel",
    "_tableModel",
    "ui",
    "table",
    "model",
    "Simple",
    "setColumns",
    "cpDaMua",
    "_read_file",
    "rowData",
    "key",
    "cp",
    "giaDaMua",
    "nguoiMua",
    "push",
    "setData",
    "timer",
    "event",
    "Timer",
    "addListener",
    "e",
    "request",
    "io",
    "Xhr",
    "setAccept",
    "setParser",
    "req",
    "getTarget",
    "response",
    "getResponse",
    "getRowCount",
    "i",
    "stock_code",
    "getValue",
    "filter_data",
    "filter",
    "x",
    "NoneSymbol",
    "console",
    "log",
    "stock_name",
    "setValue",
    "giaHienTai",
    "percent_current",
    "color_percent_current",
    "giaHienTai_html",
    "giaDaMua_new",
    "percent_change",
    "parseFloat",
    "toFixed",
    "color",
    "percent_change_html",
    "send",
    "start",
    "Table",
    "setMetaColumnCounts",
    "selectionMode",
    "selection",
    "Model",
    "MULTIPLE_INTERVAL_SELECTION",
    "getSelectionModel",
    "setSelectionMode",
    "getTableColumnModel",
    "setDataCellRenderer",
    "cellrenderer",
    "Html",
    "set",
    "width",
    "_update_table",
    "Date",
    "call_api",
    "file_name",
    "text",
    "JSON",
    "parse",
    "hoiphadaock",
    "CpDaMua"
  ],
  "sources": [
    "C:/Users/admin/PycharmProjects/hoiphadaock/source/class/hoiphadaock/CpDaMua.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\r\n\r\n   Copyright: 2022 undefined\r\n\r\n   License: MIT license\r\n\r\n   Authors: undefined\r\n\r\n************************************************************************ */\r\n\r\n/**\r\n * This is the main application class of \"hoiphadaock\"\r\n *\r\n * @asset(hoiphadaock/*)\r\n */\r\nqx.Class.define(\"hoiphadaock.CpDaMua\", {\r\n  extend: qx.application.Standalone,\r\n\r\n  members: {\r\n    createTable() {\r\n      var BACKGROUND_LO = \"#F33232\";\r\n      var BACKGROUND_LAI = \"#00E11A\";\r\n      var BACKGROUND_TRAN = \"#860D98\";\r\n      var BACKGROUND_TANG = \"#00E11A\";\r\n      var BACKGROUND_DUNG = \"#FEA50C\";\r\n      var BACKGROUND_GIAM = \"#F33232\";\r\n      var BACKGROUND_SAN = \"#0A8AE3\";\r\n      var BACKGROUND_NONE = \"#FFFFFF\";\r\n      // table model\r\n      var tableModel = (this._tableModel = new qx.ui.table.model.Simple());\r\n      tableModel.setColumns([\r\n        \"Mã CK\",\r\n        \"Name\",\r\n        \"Người mua\",\r\n        \"Giá mua\",\r\n        \"Lãi/Lỗ\",\r\n        \"Giá hiện tại\",\r\n        \"Giá min \\ntrong tuần\",\r\n        \"Giá max \\ntrong tuần\",\r\n        \"% Giá Max-Min\",\r\n        \"% Giá hiện tại\\nso với giá max\",\r\n        \"Min Time\",\r\n        \"Max Time\",\r\n        \"Giá trần\",\r\n        \"Giá sàn\",\r\n        \"Giá mở cửa\",\r\n        \"Có trong\\nInfina\",\r\n      ]);\r\n\r\n      var cpDaMua = this._read_file();\r\n      var rowData = [];\r\n      for (const key in cpDaMua) {\r\n        var cp = cpDaMua[key];\r\n        var giaDaMua = cp[\"bought\"];\r\n        var nguoiMua = cp[\"buyer\"];\r\n        rowData.push([key, \"\", nguoiMua, giaDaMua]);\r\n      }\r\n      tableModel.setData(rowData);\r\n\r\n      var timer = new qx.event.Timer(5000);\r\n      timer.addListener(\r\n        \"interval\",\r\n        function (e) {\r\n          var request = new qx.io.request.Xhr(\r\n            \"https://s.cafef.vn/ajax/marketmap.ashx?stock=1&type=1&cate=\"\r\n          );\r\n          request.setAccept(\"application/json\");\r\n          request.setParser(\"json\");\r\n          request.addListener(\"success\", function (e) {\r\n            var req = e.getTarget();\r\n            var response = req.getResponse();\r\n            var rowData = tableModel.getRowCount();\r\n            for (var i = 0; i < rowData; i++) {\r\n              var stock_code = tableModel.getValue(0, i);\r\n              var filter_data = response.filter(\r\n                (x) => x.NoneSymbol === stock_code\r\n              )[0];\r\n              console.log(\"ma ck = \" + stock_code);\r\n\r\n              var stock_name = filter_data[\"Name\"];\r\n              tableModel.setValue(1, i, stock_name);\r\n              // Giá hiện tại\r\n              var giaHienTai = filter_data[\"Price\"] * 1000;\r\n              // Phần trăm thay đổi hiện tại\r\n              var percent_current = filter_data[\"Percent\"];\r\n              var color_percent_current = BACKGROUND_DUNG;\r\n              if (percent_current == 0) {\r\n                color_percent_current = BACKGROUND_DUNG;\r\n              } else if (percent_current > 0) {\r\n                color_percent_current = BACKGROUND_TANG;\r\n              } else if (percent_current < 0) {\r\n                color_percent_current = BACKGROUND_GIAM;\r\n              }\r\n              var giaHienTai_html =\r\n                \"<div style='background-color: \" +\r\n                color_percent_current +\r\n                \";'>\" +\r\n                giaHienTai +\r\n                \"(\" +\r\n                percent_current +\r\n                \"%)</div>\";\r\n              tableModel.setValue(5, i, giaHienTai_html);\r\n\r\n              // Lãi/lỗ\r\n              var giaDaMua_new =  tableModel.getValue(3, i);\r\n              var percent_change = parseFloat(\r\n                ((giaHienTai - giaDaMua_new) / giaDaMua_new) * 100\r\n              ).toFixed(2);\r\n              var color = BACKGROUND_LAI;\r\n              if (percent_change < 0) {\r\n                color = BACKGROUND_LO;\r\n              }\r\n              var percent_change_html =\r\n                \"<div style='background-color: \" +\r\n                color +\r\n                \";'>\" +\r\n                percent_change +\r\n                \"%</div>\";\r\n              tableModel.setValue(4, i, percent_change_html);\r\n            }\r\n          });\r\n          request.send();\r\n        },\r\n        this\r\n      );\r\n      timer.start();\r\n\r\n      // table\r\n      var table = new qx.ui.table.Table(tableModel);\r\n\r\n      table.setMetaColumnCounts([1, -1]);\r\n      var selectionMode =\r\n        qx.ui.table.selection.Model.MULTIPLE_INTERVAL_SELECTION;\r\n      table.getSelectionModel().setSelectionMode(selectionMode);\r\n      table\r\n        .getTableColumnModel()\r\n        .setDataCellRenderer(4, new qx.ui.table.cellrenderer.Html());\r\n      table\r\n        .getTableColumnModel()\r\n        .setDataCellRenderer(5, new qx.ui.table.cellrenderer.Html());\r\n\r\n      table.set({ width: 700 });\r\n      return table;\r\n    },\r\n    _update_table(tableModel) {\r\n      // tableModel.setValue(1, 1, \"xxx\");\r\n      console.log(new Date());\r\n    },\r\n    call_api() {\r\n      var request = new qx.io.request.Xhr(\r\n        \"https://s.cafef.vn/ajax/marketmap.ashx?stock=1&type=1&cate=\"\r\n      );\r\n      request.setAccept(\"application/json\");\r\n      request.setParser(\"json\");\r\n      request.addListener(\r\n        \"success\",\r\n        function (e) {\r\n          var req = e.getTarget();\r\n          var response = req.getResponse();\r\n        },\r\n        this\r\n      );\r\n      request.send();\r\n    },\r\n    _read_file() {\r\n      var file_name = \"data/da_mua.json\";\r\n      //   const text =\r\n      //     '{\"EIB\":{\"bought\":31400,\"buyer\":\"Tuyết-NTA\"},\"HBC\":{\"bought\":21100,\"buyer\":\"Mỹ Mỹ\"},\"OCB\":{\"bought\":20350,\"buyer\":\"Mỹ Đạt\"},\"VHC\":{\"bought\":102500,\"buyer\":\"Đạt-NT\"},\"BCM\":{\"bought\":72300,\"buyer\":\"Tuyết-NTA\"},\"LPB\":{\"bought\":13150,\"buyer\":\"Mỹ Mỹ\"},\"CTG\":{\"bought\":25250,\"buyer\":\"Đạt-NT\"},\"VSH\":{\"bought\":46100,\"buyer\":\"Đạt-NT\"},\"DPM\":{\"bought\":48900,\"buyer\":\"\"},\"VIB\":{\"bought\":20900,\"buyer\":\"Đạt-NT\"},\"VIP\":{\"bought\":6330,\"buyer\":\"Đạt-NT\"},\"AST\":{\"bought\":57900,\"buyer\":\"\"}}';\r\n      const text =\r\n        '{\"EIB\":{\"bought\":31400,\"buyer\":\"Tuyết-NTA\"},\"HBC\":{\"bought\":21100,\"buyer\":\"Mỹ Mỹ\"},\"OCB\":{\"bought\":20350,\"buyer\":\"Mỹ Đạt\"},\"VHC\":{\"bought\":102500,\"buyer\":\"Đạt-NT\"},\"BCM\":{\"bought\":72300,\"buyer\":\"Tuyết-NTA\"},\"LPB\":{\"bought\":13150,\"buyer\":\"Mỹ Mỹ\"},\"VSH\":{\"bought\":46100,\"buyer\":\"Đạt-NT\"},\"VIB\":{\"bought\":20900,\"buyer\":\"Đạt-NT\"},\"VIP\":{\"bought\":6330,\"buyer\":\"Đạt-NT\"}}';\r\n      return JSON.parse(text);\r\n    },\r\n  },\r\n});\r\n"
  ],
  "mappings": "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"
}