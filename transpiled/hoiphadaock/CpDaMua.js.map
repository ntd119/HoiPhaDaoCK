{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "application",
    "Standalone",
    "members",
    "createTable",
    "BACKGROUND_LO",
    "BACKGROUND_LAI",
    "BACKGROUND_TRAN",
    "BACKGROUND_TANG",
    "BACKGROUND_DUNG",
    "BACKGROUND_GIAM",
    "BACKGROUND_SAN",
    "BACKGROUND_NONE",
    "tableModel",
    "_tableModel",
    "ui",
    "table",
    "model",
    "Simple",
    "setColumns",
    "cpDaMua",
    "_read_file",
    "rowData",
    "request",
    "io",
    "Xhr",
    "setAccept",
    "setParser",
    "addListener",
    "e",
    "req",
    "getTarget",
    "response",
    "getResponse",
    "key",
    "filter_data",
    "filter",
    "x",
    "NoneSymbol",
    "cp",
    "giaDaMua",
    "nguoiMua",
    "stock_name",
    "giaHienTai",
    "percent_current",
    "color_percent_current",
    "giaHienTai_html",
    "percent_change",
    "parseFloat",
    "toFixed",
    "color",
    "percent_change_html",
    "push",
    "setData",
    "timer",
    "event",
    "Timer",
    "request2",
    "getRowCount",
    "req2",
    "response2",
    "i",
    "stock_code2",
    "getValue",
    "filter_data2",
    "console",
    "log",
    "send",
    "start",
    "Table",
    "setMetaColumnCounts",
    "selectionMode",
    "selection",
    "Model",
    "MULTIPLE_INTERVAL_SELECTION",
    "getSelectionModel",
    "setSelectionMode",
    "getTableColumnModel",
    "setDataCellRenderer",
    "cellrenderer",
    "Html",
    "set",
    "width",
    "_update_table",
    "Date",
    "call_api",
    "file_name",
    "text",
    "JSON",
    "parse",
    "hoiphadaock",
    "CpDaMua"
  ],
  "sources": [
    "C:/Users/admin/PycharmProjects/hoiphadaock/source/class/hoiphadaock/CpDaMua.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\r\n\r\n   Copyright: 2022 undefined\r\n\r\n   License: MIT license\r\n\r\n   Authors: undefined\r\n\r\n************************************************************************ */\r\n\r\n/**\r\n * This is the main application class of \"hoiphadaock\"\r\n *\r\n * @asset(hoiphadaock/*)\r\n */\r\nqx.Class.define(\"hoiphadaock.CpDaMua\", {\r\n  extend: qx.application.Standalone,\r\n\r\n  members: {\r\n    createTable() {\r\n      var BACKGROUND_LO = \"#F33232\";\r\n      var BACKGROUND_LAI = \"#00E11A\";\r\n      var BACKGROUND_TRAN = \"#860D98\";\r\n      var BACKGROUND_TANG = \"#00E11A\";\r\n      var BACKGROUND_DUNG = \"#FEA50C\";\r\n      var BACKGROUND_GIAM = \"#F33232\";\r\n      var BACKGROUND_SAN = \"#0A8AE3\";\r\n      var BACKGROUND_NONE = \"#FFFFFF\";\r\n      // table model\r\n      var tableModel = (this._tableModel = new qx.ui.table.model.Simple());\r\n      tableModel.setColumns([\r\n        \"Mã CK\",\r\n        \"Name\",\r\n        \"Người mua\",\r\n        \"Giá mua\",\r\n        \"Lãi/Lỗ\",\r\n        \"Giá hiện tại\",\r\n        \"Giá min \\ntrong tuần\",\r\n        \"Giá max \\ntrong tuần\",\r\n        \"% Giá Max-Min\",\r\n        \"% Giá hiện tại\\nso với giá max\",\r\n        \"Min Time\",\r\n        \"Max Time\",\r\n        \"Giá trần\",\r\n        \"Giá sàn\",\r\n        \"Giá mở cửa\",\r\n        \"Có trong\\nInfina\",\r\n      ]);\r\n\r\n      var cpDaMua = this._read_file();\r\n      var rowData = [];\r\n      var request = new qx.io.request.Xhr(\r\n        \"https://s.cafef.vn/ajax/marketmap.ashx?stock=1&type=1&cate=\"\r\n      );\r\n      request.setAccept(\"application/json\");\r\n      request.setParser(\"json\");\r\n      request.addListener(\"success\", function (e) {\r\n        var req = e.getTarget();\r\n        var response = req.getResponse();\r\n        for (const key in cpDaMua) {\r\n          var filter_data = response.filter((x) => x.NoneSymbol === key)[0];\r\n          var cp = cpDaMua[key];\r\n          var giaDaMua = cp[\"bought\"];\r\n          var nguoiMua = cp[\"buyer\"];\r\n          var stock_name = filter_data[\"Name\"];\r\n          // Giá hiện tại\r\n          var giaHienTai = filter_data[\"Price\"] * 1000;\r\n          // Phần trăm thay đổi hiện tại\r\n          var percent_current = filter_data[\"Percent\"];\r\n          var color_percent_current = BACKGROUND_DUNG;\r\n          if (percent_current == 0) {\r\n            color_percent_current = BACKGROUND_DUNG;\r\n          } else if (percent_current > 0) {\r\n            color_percent_current = BACKGROUND_TANG;\r\n          } else if (percent_current < 0) {\r\n            color_percent_current = BACKGROUND_GIAM;\r\n          }\r\n          var giaHienTai_html =\r\n            \"<div style='background-color: \" +\r\n            color_percent_current +\r\n            \";'>\" +\r\n            giaHienTai +\r\n            \"(\" +\r\n            percent_current +\r\n            \"%)</div>\";\r\n\r\n          // Lãi/lỗ\r\n          var percent_change = parseFloat(\r\n            ((giaHienTai - giaDaMua) / giaDaMua) * 100\r\n          ).toFixed(2);\r\n          var color = BACKGROUND_LAI;\r\n          if (percent_change < 0) {\r\n            color = BACKGROUND_LO;\r\n          }\r\n          var percent_change_html =\r\n            \"<div style='background-color: \" +\r\n            color +\r\n            \";'>\" +\r\n            percent_change +\r\n            \"%</div>\";\r\n\r\n          rowData.push([\r\n            key,\r\n            stock_name,\r\n            nguoiMua,\r\n            giaDaMua,\r\n            percent_change_html,\r\n            giaHienTai_html,\r\n          ]);\r\n        }\r\n        tableModel.setData(rowData);\r\n\r\n        var timer = new qx.event.Timer(5000);\r\n        timer.addListener(\r\n          \"interval\",\r\n          function (e) {\r\n            var request2 = new qx.io.request.Xhr(\r\n              \"https://s.cafef.vn/ajax/marketmap.ashx?stock=1&type=1&cate=\"\r\n            );\r\n            request2.setAccept(\"application/json\");\r\n            request2.setParser(\"json\");\r\n            request2.addListener(\"success\", function (e) {\r\n              var rowData = tableModel.getRowCount();\r\n              var req2 = e.getTarget();\r\n              var response2 = req2.getResponse();\r\n              for (var i = 0; i < rowData; i++) {\r\n                var stock_code2 = tableModel.getValue(0, i);\r\n                var filter_data2 = response2.filter((x) => x.NoneSymbol === stock_code2)[0];\r\n                // tableModel.setValue(5, i, i);\r\n                console.log(\"ma ck = \" + filter_data2);\r\n              }\r\n              // console.log(\"row = \" + rowData);\r\n              // console.log(new Date());\r\n            });\r\n            request2.send();\r\n          },\r\n          this\r\n        );\r\n        timer.start();\r\n      });\r\n      request.send();\r\n\r\n      // table\r\n      var table = new qx.ui.table.Table(tableModel);\r\n\r\n      table.setMetaColumnCounts([1, -1]);\r\n      var selectionMode =\r\n        qx.ui.table.selection.Model.MULTIPLE_INTERVAL_SELECTION;\r\n      table.getSelectionModel().setSelectionMode(selectionMode);\r\n      table\r\n        .getTableColumnModel()\r\n        .setDataCellRenderer(4, new qx.ui.table.cellrenderer.Html());\r\n      table\r\n        .getTableColumnModel()\r\n        .setDataCellRenderer(5, new qx.ui.table.cellrenderer.Html());\r\n\r\n      table.set({ width: 700 });\r\n      return table;\r\n    },\r\n    _update_table(tableModel) {\r\n      // tableModel.setValue(1, 1, \"xxx\");\r\n      console.log(new Date());\r\n    },\r\n    call_api() {\r\n      var request = new qx.io.request.Xhr(\r\n        \"https://s.cafef.vn/ajax/marketmap.ashx?stock=1&type=1&cate=\"\r\n      );\r\n      request.setAccept(\"application/json\");\r\n      request.setParser(\"json\");\r\n      request.addListener(\r\n        \"success\",\r\n        function (e) {\r\n          var req = e.getTarget();\r\n          var response = req.getResponse();\r\n        },\r\n        this\r\n      );\r\n      request.send();\r\n    },\r\n    _read_file() {\r\n      var file_name = \"data/da_mua.json\";\r\n      //   const text =\r\n      //     '{\"EIB\":{\"bought\":31400,\"buyer\":\"Tuyết-NTA\"},\"HBC\":{\"bought\":21100,\"buyer\":\"Mỹ Mỹ\"},\"OCB\":{\"bought\":20350,\"buyer\":\"Mỹ Đạt\"},\"VHC\":{\"bought\":102500,\"buyer\":\"Đạt-NT\"},\"BCM\":{\"bought\":72300,\"buyer\":\"Tuyết-NTA\"},\"LPB\":{\"bought\":13150,\"buyer\":\"Mỹ Mỹ\"},\"CTG\":{\"bought\":25250,\"buyer\":\"Đạt-NT\"},\"VSH\":{\"bought\":46100,\"buyer\":\"Đạt-NT\"},\"DPM\":{\"bought\":48900,\"buyer\":\"\"},\"VIB\":{\"bought\":20900,\"buyer\":\"Đạt-NT\"},\"VIP\":{\"bought\":6330,\"buyer\":\"Đạt-NT\"},\"AST\":{\"bought\":57900,\"buyer\":\"\"}}';\r\n      const text =\r\n        '{\"EIB\":{\"bought\":31400,\"buyer\":\"Tuyết-NTA\"},\"HBC\":{\"bought\":21100,\"buyer\":\"Mỹ Mỹ\"},\"OCB\":{\"bought\":20350,\"buyer\":\"Mỹ Đạt\"},\"VHC\":{\"bought\":102500,\"buyer\":\"Đạt-NT\"},\"BCM\":{\"bought\":72300,\"buyer\":\"Tuyết-NTA\"},\"LPB\":{\"bought\":13150,\"buyer\":\"Mỹ Mỹ\"},\"VSH\":{\"bought\":46100,\"buyer\":\"Đạt-NT\"},\"VIB\":{\"bought\":20900,\"buyer\":\"Đạt-NT\"},\"VIP\":{\"bought\":6330,\"buyer\":\"Đạt-NT\"}}';\r\n      return JSON.parse(text);\r\n    },\r\n  },\r\n});\r\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;AACA;AACA;EACAH,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,qBAAhB,EAAuC;IACrCC,MAAM,EAAEN,EAAE,CAACO,WAAH,CAAeC,UADc;IAGrCC,OAAO,EAAE;MACPC,WADO,yBACO;QACZ,IAAIC,aAAa,GAAG,SAApB;QACA,IAAIC,cAAc,GAAG,SAArB;QACA,IAAIC,eAAe,GAAG,SAAtB;QACA,IAAIC,eAAe,GAAG,SAAtB;QACA,IAAIC,eAAe,GAAG,SAAtB;QACA,IAAIC,eAAe,GAAG,SAAtB;QACA,IAAIC,cAAc,GAAG,SAArB;QACA,IAAIC,eAAe,GAAG,SAAtB,CARY,CASZ;;QACA,IAAIC,UAAU,GAAI,KAAKC,WAAL,GAAmB,IAAIpB,EAAE,CAACqB,EAAH,CAAMC,KAAN,CAAYC,KAAZ,CAAkBC,MAAtB,EAArC;QACAL,UAAU,CAACM,UAAX,CAAsB,CACpB,OADoB,EAEpB,MAFoB,EAGpB,WAHoB,EAIpB,SAJoB,EAKpB,QALoB,EAMpB,cANoB,EAOpB,sBAPoB,EAQpB,sBARoB,EASpB,eAToB,EAUpB,gCAVoB,EAWpB,UAXoB,EAYpB,UAZoB,EAapB,UAboB,EAcpB,SAdoB,EAepB,YAfoB,EAgBpB,kBAhBoB,CAAtB;;QAmBA,IAAIC,OAAO,GAAG,KAAKC,UAAL,EAAd;;QACA,IAAIC,OAAO,GAAG,EAAd;QACA,IAAIC,OAAO,GAAG,IAAI7B,EAAE,CAAC8B,EAAH,CAAMD,OAAN,CAAcE,GAAlB,CACZ,6DADY,CAAd;QAGAF,OAAO,CAACG,SAAR,CAAkB,kBAAlB;QACAH,OAAO,CAACI,SAAR,CAAkB,MAAlB;QACAJ,OAAO,CAACK,WAAR,CAAoB,SAApB,EAA+B,UAAUC,CAAV,EAAa;UAC1C,IAAIC,GAAG,GAAGD,CAAC,CAACE,SAAF,EAAV;UACA,IAAIC,QAAQ,GAAGF,GAAG,CAACG,WAAJ,EAAf;;UAF0C,2BAG/BC,GAH+B;YAIpCC,WAAW,GAAGH,QAAQ,CAACI,MAAT,CAAgB,UAACC,CAAD;cAAA,OAAOA,CAAC,CAACC,UAAF,KAAiBJ,GAAxB;YAAA,CAAhB,EAA6C,CAA7C,CAJsB;YAKpCK,EAAE,GAAGnB,OAAO,CAACc,GAAD,CALwB;YAMpCM,QAAQ,GAAGD,EAAE,CAAC,QAAD,CANuB;YAOpCE,QAAQ,GAAGF,EAAE,CAAC,OAAD,CAPuB;YAQpCG,UAAU,GAAGP,WAAW,CAAC,MAAD,CARY,EASxC;;YACIQ,UAAU,GAAGR,WAAW,CAAC,OAAD,CAAX,GAAuB,IAVA,EAWxC;;YACIS,eAAe,GAAGT,WAAW,CAAC,SAAD,CAZO;YAapCU,qBAAqB,GAAGpC,eAbY;;YAcxC,IAAImC,eAAe,IAAI,CAAvB,EAA0B;cACxBC,qBAAqB,GAAGpC,eAAxB;YACD,CAFD,MAEO,IAAImC,eAAe,GAAG,CAAtB,EAAyB;cAC9BC,qBAAqB,GAAGrC,eAAxB;YACD,CAFM,MAEA,IAAIoC,eAAe,GAAG,CAAtB,EAAyB;cAC9BC,qBAAqB,GAAGnC,eAAxB;YACD;;YACGoC,eAAe,GACjB,mCACAD,qBADA,GAEA,KAFA,GAGAF,UAHA,GAIA,GAJA,GAKAC,eALA,GAMA,UA5BsC,EA8BxC;;YACIG,cAAc,GAAGC,UAAU,CAC5B,CAACL,UAAU,GAAGH,QAAd,IAA0BA,QAA3B,GAAuC,GADV,CAAV,CAEnBS,OAFmB,CAEX,CAFW,CA/BmB;YAkCpCC,KAAK,GAAG5C,cAlC4B;;YAmCxC,IAAIyC,cAAc,GAAG,CAArB,EAAwB;cACtBG,KAAK,GAAG7C,aAAR;YACD;;YACG8C,mBAAmB,GACrB,mCACAD,KADA,GAEA,KAFA,GAGAH,cAHA,GAIA,SA3CsC;YA6CxCzB,OAAO,CAAC8B,IAAR,CAAa,CACXlB,GADW,EAEXQ,UAFW,EAGXD,QAHW,EAIXD,QAJW,EAKXW,mBALW,EAMXL,eANW,CAAb;UA7CwC;;UAG1C,KAAK,IAAMZ,GAAX,IAAkBd,OAAlB,EAA2B;YAAA,IACrBe,WADqB;YAAA,IAErBI,EAFqB;YAAA,IAGrBC,QAHqB;YAAA,IAIrBC,QAJqB;YAAA,IAKrBC,UALqB;YAAA,IAOrBC,UAPqB;YAAA,IASrBC,eATqB;YAAA,IAUrBC,qBAVqB;YAAA,IAkBrBC,eAlBqB;YAAA,IA4BrBC,cA5BqB;YAAA,IA+BrBG,KA/BqB;YAAA,IAmCrBC,mBAnCqB;;YAAA,MAAhBjB,GAAgB;UAkD1B;;UACDrB,UAAU,CAACwC,OAAX,CAAmB/B,OAAnB;UAEA,IAAIgC,KAAK,GAAG,IAAI5D,EAAE,CAAC6D,KAAH,CAASC,KAAb,CAAmB,IAAnB,CAAZ;UACAF,KAAK,CAAC1B,WAAN,CACE,UADF,EAEE,UAAUC,CAAV,EAAa;YACX,IAAI4B,QAAQ,GAAG,IAAI/D,EAAE,CAAC8B,EAAH,CAAMD,OAAN,CAAcE,GAAlB,CACb,6DADa,CAAf;YAGAgC,QAAQ,CAAC/B,SAAT,CAAmB,kBAAnB;YACA+B,QAAQ,CAAC9B,SAAT,CAAmB,MAAnB;YACA8B,QAAQ,CAAC7B,WAAT,CAAqB,SAArB,EAAgC,UAAUC,CAAV,EAAa;cAC3C,IAAIP,OAAO,GAAGT,UAAU,CAAC6C,WAAX,EAAd;cACA,IAAIC,IAAI,GAAG9B,CAAC,CAACE,SAAF,EAAX;cACA,IAAI6B,SAAS,GAAGD,IAAI,CAAC1B,WAAL,EAAhB;;cACA,KAAK,IAAI4B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGvC,OAApB,EAA6BuC,CAAC,EAA9B,EAAkC;gBAChC,IAAIC,WAAW,GAAGjD,UAAU,CAACkD,QAAX,CAAoB,CAApB,EAAuBF,CAAvB,CAAlB;gBACA,IAAIG,YAAY,GAAGJ,SAAS,CAACxB,MAAV,CAAiB,UAACC,CAAD;kBAAA,OAAOA,CAAC,CAACC,UAAF,KAAiBwB,WAAxB;gBAAA,CAAjB,EAAsD,CAAtD,CAAnB,CAFgC,CAGhC;;gBACAG,OAAO,CAACC,GAAR,CAAY,aAAaF,YAAzB;cACD,CAT0C,CAU3C;cACA;;YACD,CAZD;YAaAP,QAAQ,CAACU,IAAT;UACD,CAtBH,EAuBE,IAvBF;UAyBAb,KAAK,CAACc,KAAN;QACD,CAnFD;QAoFA7C,OAAO,CAAC4C,IAAR,GAzHY,CA2HZ;;QACA,IAAInD,KAAK,GAAG,IAAItB,EAAE,CAACqB,EAAH,CAAMC,KAAN,CAAYqD,KAAhB,CAAsBxD,UAAtB,CAAZ;QAEAG,KAAK,CAACsD,mBAAN,CAA0B,CAAC,CAAD,EAAI,CAAC,CAAL,CAA1B;QACA,IAAIC,aAAa,GACf7E,EAAE,CAACqB,EAAH,CAAMC,KAAN,CAAYwD,SAAZ,CAAsBC,KAAtB,CAA4BC,2BAD9B;QAEA1D,KAAK,CAAC2D,iBAAN,GAA0BC,gBAA1B,CAA2CL,aAA3C;QACAvD,KAAK,CACF6D,mBADH,GAEGC,mBAFH,CAEuB,CAFvB,EAE0B,IAAIpF,EAAE,CAACqB,EAAH,CAAMC,KAAN,CAAY+D,YAAZ,CAAyBC,IAA7B,EAF1B;QAGAhE,KAAK,CACF6D,mBADH,GAEGC,mBAFH,CAEuB,CAFvB,EAE0B,IAAIpF,EAAE,CAACqB,EAAH,CAAMC,KAAN,CAAY+D,YAAZ,CAAyBC,IAA7B,EAF1B;QAIAhE,KAAK,CAACiE,GAAN,CAAU;UAAEC,KAAK,EAAE;QAAT,CAAV;QACA,OAAOlE,KAAP;MACD,CA5IM;MA6IPmE,aA7IO,yBA6IOtE,UA7IP,EA6ImB;QACxB;QACAoD,OAAO,CAACC,GAAR,CAAY,IAAIkB,IAAJ,EAAZ;MACD,CAhJM;MAiJPC,QAjJO,sBAiJI;QACT,IAAI9D,OAAO,GAAG,IAAI7B,EAAE,CAAC8B,EAAH,CAAMD,OAAN,CAAcE,GAAlB,CACZ,6DADY,CAAd;QAGAF,OAAO,CAACG,SAAR,CAAkB,kBAAlB;QACAH,OAAO,CAACI,SAAR,CAAkB,MAAlB;QACAJ,OAAO,CAACK,WAAR,CACE,SADF,EAEE,UAAUC,CAAV,EAAa;UACX,IAAIC,GAAG,GAAGD,CAAC,CAACE,SAAF,EAAV;UACA,IAAIC,QAAQ,GAAGF,GAAG,CAACG,WAAJ,EAAf;QACD,CALH,EAME,IANF;QAQAV,OAAO,CAAC4C,IAAR;MACD,CAhKM;MAiKP9C,UAjKO,wBAiKM;QACX,IAAIiE,SAAS,GAAG,kBAAhB,CADW,CAEX;QACA;;QACA,IAAMC,IAAI,GACR,+WADF;QAEA,OAAOC,IAAI,CAACC,KAAL,CAAWF,IAAX,CAAP;MACD;IAxKM;EAH4B,CAAvC;EAfAG,WAAW,CAACC,OAAZ,CAAoB9F,aAApB,GAAoCA,aAApC"
}